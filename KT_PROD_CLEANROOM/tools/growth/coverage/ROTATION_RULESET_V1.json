{
  "schema_version": "ROTATION_RULESET_V1",
  "ruleset_id": "ROT_V1",
  "description": "Fail-closed rotation + coverage gates for crucibles, epochs, cycles. Canonical IDs only. Missing fields -> FAIL.",
  "fail_closed": true,
  "canonical_ids": {
    "domain_prefix": "D:",
    "subdomain_prefix": "S:",
    "microdomain_prefix": "M:",
    "venture_prefix": "V:",
    "reasoning_prefix": "R:",
    "modality_prefix": "X:",
    "paradox_prefix": "P:",
    "tool_prefix": "T:",
    "id_format": {
      "domain": "^D:[A-Z0-9_]+$",
      "subdomain": "^S:[A-Z0-9_]+(\\.[A-Z0-9_]+)+$",
      "microdomain": "^M:[A-Z0-9_]+(\\.[A-Z0-9_]+)+$",
      "venture": "^V:[A-Z0-9_]+(\\.[A-Z0-9_]+)+$",
      "reasoning": "^R:[A-Z0-9_]+$",
      "modality": "^X:[A-Z0-9_]+$",
      "paradox": "^P:[A-Z0-9_]+(\\.[A-Z0-9_]+)*$",
      "tool": "^T:[A-Z0-9_]+(\\.[A-Z0-9_]+)*$"
    }
  },
  "required_coverage_fields": {
    "crucible_coverage_required": [
      "schema_version",
      "run_id",
      "epoch_id",
      "crucible_id",
      "kernel_target",
      "planned",
      "observed",
      "proof",
      "verdict"
    ],
    "observed_required": [
      "domains",
      "subdomains",
      "microdomains",
      "reasoning_modes",
      "modalities",
      "tools",
      "counts",
      "dominance"
    ],
    "counts_required": [
      "unique_domains",
      "unique_subdomains",
      "unique_microdomains",
      "cross_domain_edges",
      "mean_graph_distance",
      "max_graph_distance",
      "paradox_events"
    ],
    "dominance_required": [
      "top_domain_share",
      "top_5_domain_share",
      "entropy_domains"
    ],
    "proof_required": [
      "receipts",
      "fail_closed"
    ]
  },
  "verdict_codes": {
    "PASS": "PASS",
    "FAIL": "FAIL",
    "FAIL_MISSING_FIELD": "FAIL_MISSING_FIELD",
    "FAIL_INVALID_ID": "FAIL_INVALID_ID",
    "FAIL_THRESHOLD": "FAIL_THRESHOLD",
    "FAIL_SEQUENCE_ROTATION": "FAIL_SEQUENCE_ROTATION",
    "FAIL_BUNDLE": "FAIL_BUNDLE",
    "FAIL_FORBIDDEN_TAG": "FAIL_FORBIDDEN_TAG",
    "FAIL_REQUIRED_TAG": "FAIL_REQUIRED_TAG",
    "FAIL_RECEIPT_MISSING": "FAIL_RECEIPT_MISSING"
  },
  "receipts_policy": {
    "required_receipt_types": [
      "TRACE_HEAD_HASH",
      "LEDGER_ENTRY_HASH"
    ],
    "require_sha256": true,
    "sha256_format": "^[a-f0-9]{64}$",
    "fail_if_missing": true
  },
  "crucible_constraints": {
    "thresholds": {
      "min_unique_domains": 120,
      "min_unique_subdomains": 300,
      "min_unique_microdomains": 500,
      "min_cross_domain_edges": 400,
      "min_mean_graph_distance": 3.0,
      "max_top_domain_share": 0.30,
      "max_top_5_domain_share": 0.75,
      "min_entropy_domains": 4.0,
      "min_paradox_events": 0
    },
    "required_tags": {
      "domains": [],
      "subdomains": [],
      "microdomains": [],
      "ventures": [],
      "reasoning_modes": [],
      "modalities": [],
      "tools": [],
      "paradox_classes": []
    },
    "forbidden_tags": {
      "domains": [],
      "subdomains": [],
      "microdomains": [],
      "ventures": [],
      "reasoning_modes": [],
      "modalities": [],
      "tools": [],
      "paradox_classes": []
    },
    "sequence_rotation": {
      "enabled": true,
      "max_consecutive_same_domain": 1,
      "max_consecutive_same_subdomain": 1,
      "max_consecutive_same_microdomain": 2
    }
  },
  "epoch_constraints": {
    "thresholds": {
      "min_unique_domains": 500,
      "min_unique_subdomains": 1200,
      "min_unique_microdomains": 2500,
      "min_cross_domain_edges": 7000,
      "min_mean_graph_distance": 3.5,
      "max_top_domain_share": 0.25,
      "max_top_5_domain_share": 0.70,
      "min_entropy_domains": 4.8
    },
    "sequence_rotation": {
      "enabled": true,
      "max_consecutive_same_domain": 1,
      "max_consecutive_same_subdomain": 1,
      "min_graph_distance_between_adjacent": 2
    },
    "required_bundles": [],
    "forbidden_bundles": []
  },
  "cycle_constraints": {
    "thresholds": {
      "min_unique_domains": 1200,
      "min_unique_subdomains": 3000,
      "min_unique_microdomains": 6000,
      "min_ventures": 12,
      "min_cross_venture_edges": 9000,
      "max_top_domain_share": 0.22,
      "max_top_5_domain_share": 0.66,
      "min_entropy_domains": 5.0
    },
    "required_ventures": [],
    "required_bundles": [],
    "forbidden_bundles": []
  },
  "bundle_library": [
    {
      "bundle_id": "BUNDLE:VENTURE.TRADING_BOT.CORE",
      "description": "Example bundle. Replace/extend with your ontology.",
      "required_tags": {
        "domains": ["D:GOV", "D:MATH"],
        "subdomains": ["S:GOV.HONESTY", "S:MATH.PROBABILITY"],
        "microdomains": [],
        "ventures": ["V:VENTURE.TRADING_BOT"],
        "reasoning_modes": [],
        "modalities": [],
        "tools": [],
        "paradox_classes": []
      },
      "bridge_pairs": [
        ["S:GOV.HONESTY", "S:MATH.PROBABILITY"]
      ],
      "min_bridge_edges": 10
    }
  ],
  "enforcement_notes": [
    "Validation order is fail-closed: (1) required fields present, (2) canonical ID regex pass, (3) forbidden tags absent, (4) required tags present, (5) thresholds pass, (6) sequence rotation pass, (7) bundles satisfied, (8) receipts present and sha256-valid.",
    "Any missing field or unknown type -> verdict FAIL with FAIL_MISSING_FIELD.",
    "Any non-canonical ID -> verdict FAIL with FAIL_INVALID_ID.",
    "Receipts missing -> verdict FAIL with FAIL_RECEIPT_MISSING.",
    "Threshold violations -> verdict FAIL with FAIL_THRESHOLD; include failed keys.",
    "Sequence rotation violations -> verdict FAIL with FAIL_SEQUENCE_ROTATION; include the offending adjacency windows."
  ]
}
