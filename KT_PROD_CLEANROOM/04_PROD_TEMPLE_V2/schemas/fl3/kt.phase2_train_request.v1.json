{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "KT Phase2 Train Request v1 (MRT-1 weight-bearing lane)",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schema_id",
    "schema_version_hash",
    "schema_version",
    "train_request_id",
    "work_order_id",
    "pinned_sha",
    "adapter_id",
    "adapter_version",
    "role_id",
    "training_mode",
    "base_model",
    "dataset_manifest_ref",
    "seed",
    "device",
    "output",
    "created_at"
  ],
  "properties": {
    "schema_id": { "const": "kt.phase2_train_request.v1" },
    "schema_version_hash": { "type": "string", "pattern": "^[0-9a-f]{64}$" },
    "schema_version": { "type": "integer", "const": 1 },
    "train_request_id": { "type": "string", "pattern": "^[0-9a-f]{64}$" },
    "work_order_id": { "type": "string", "minLength": 1 },
    "pinned_sha": { "type": "string", "pattern": "^[0-9a-f]{40}$" },
    "adapter_id": { "type": "string", "minLength": 1 },
    "adapter_version": { "type": "string", "minLength": 1 },
    "role_id": { "type": "string", "minLength": 1 },
    "training_mode": { "type": "string", "enum": [ "lora_mrt1" ] },
    "base_model": {
      "type": "object",
      "additionalProperties": false,
      "required": [ "model_id", "local_path" ],
      "properties": {
        "model_id": { "type": "string", "minLength": 1 },
        "local_path": { "type": "string", "minLength": 1 }
      }
    },
    "dataset_manifest_ref": {
      "type": "object",
      "additionalProperties": false,
      "required": [ "path", "sha256" ],
      "properties": {
        "path": { "type": "string", "minLength": 1 },
        "sha256": { "type": "string", "pattern": "^[0-9a-f]{64}$" }
      }
    },
    "seed": { "type": "integer" },
    "device": { "type": "string", "enum": [ "auto", "cpu", "cuda" ] },
    "output": {
      "type": "object",
      "additionalProperties": false,
      "required": [ "export_root_shadow", "export_root_promoted" ],
      "properties": {
        "export_root_shadow": { "type": "string", "minLength": 1 },
        "export_root_promoted": { "type": "string", "minLength": 1 }
      }
    },
    "created_at": { "type": "string", "format": "date-time" }
  }
}

